import{s as i}from"./supabaseClient.BBNiQqDa.js";document.getElementById("newsForm")?.addEventListener("submit",async o=>{o.preventDefault();const c=o.target,r=new FormData(c),t=r.get("news_image");let n=null;if(t)try{const e=`${Date.now()}_${t.name}`,{data:a,error:s}=await i.storage.from("Images").upload(e,t);if(s)throw s;const{data:m}=i.storage.from("Images").getPublicUrl(a.path);n=m.publicUrl}catch(e){console.error("Error uploading image:",e),alert("Erreur lors du téléchargement de l'image.");return}const l={title:r.get("title"),summary:r.get("summary"),content:r.get("content"),image:n,date:new Date().toISOString(),published:r.get("published")==="on"};try{const e=await fetch("/api/news",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!e.ok){const a=await e.json();throw new Error(a.message||"Error creating article")}window.location.href="/admin/news"}catch(e){console.error("Error:",e),alert(e instanceof Error?e.message:"Error creating article")}});
